# =================================================================
# PII字段加密配置模板
# =================================================================
#
# 说明: 将此配置添加到Nacos配置中心的 common.yml 或 luohuo-oauth-server-dev.yml
# Data ID: common.yml 或 luohuo-oauth-server-dev.yml
# Group: DEFAULT_GROUP
# 配置格式: YAML
#
# 生成密钥命令: openssl rand -base64 32
# =================================================================

# ===== P0修复: PII字段加密配置 (2025-12-13) =====
pii:
  encryption:
    # ⚠️ PII加密密钥 (Base64编码的32字节密钥)
    # 警告: 以下是示例密钥，生产环境必须替换！
    # 生成命令: openssl rand -base64 32
    key: "a7B9cD2eF4gH6iJ8kL0mN2oP4qR6sT8uV0wX2yZ4aB6c="

    # 是否启用PII加密功能（默认: true）
    enabled: true

# =================================================================
# 生产环境配置示例 (luohuo-oauth-server-prod.yml)
# =================================================================
# pii:
#   encryption:
#     # 方式1: 从环境变量读取 (推荐)
#     key: ${PII_ENCRYPTION_KEY}
#
#     # 方式2: 从Vault读取 (需要集成Spring Cloud Vault)
#     # key: ${vault:secret/data/hula/pii#encryption-key}
#
#     enabled: true

# =================================================================
# 环境变量配置示例 (服务器systemd配置)
# =================================================================
# 文件: /etc/systemd/system/luohuo-oauth-server.service
#
# [Service]
# Environment="PII_ENCRYPTION_KEY=YOUR_ACTUAL_BASE64_ENCODED_KEY_HERE"
# =================================================================

# =================================================================
# 密钥管理最佳实践
# =================================================================
# 1. ✅ 使用KMS (密钥管理服务)
#    - AWS KMS
#    - Azure Key Vault
#    - 阿里云KMS
#
# 2. ✅ 使用Vault
#    - HashiCorp Vault
#
# 3. ✅ Nacos加密配置
#    - 使用Nacos的配置加密功能
#
# 4. ⚠️ 环境变量 (开发环境可用)
#    - 通过环境变量传递密钥
#
# 5. ❌ 禁止在代码中硬编码密钥
# 6. ❌ 禁止在Git仓库中提交密钥
# =================================================================

# =================================================================
# 配置验证
# =================================================================
# 启动应用后检查日志:
#   tail -f logs/luohuo-oauth-server.log | grep "PII加密器"
#
# 应该看到:
#   INFO  PII加密器初始化成功 (AES-256-GCM)
# =================================================================

# =================================================================
# 数据迁移说明
# =================================================================
# 1. 配置完成后，新数据将自动加密
# 2. 历史数据需要执行迁移脚本
# 3. 迁移API: POST /admin/migration/encrypt-pii?batchSize=1000
# 4. 验证API: GET /admin/migration/verify-pii
# 5. 详细步骤请参考: PII_ENCRYPTION_SETUP_GUIDE.md
# =================================================================
